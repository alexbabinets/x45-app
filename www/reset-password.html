<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover">
  <title>Reset Your Password – X45</title>
  <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
  <style>
    body { background:#000; color:#fff; font-family:Arial,system-ui,-apple-system,Segoe UI,Roboto,Helvetica,sans-serif; display:flex; flex-direction:column; align-items:center; justify-content:center; min-height:100vh; margin:0; padding:20px; }
    .logo { width:120px; margin-bottom:18px; }
    h1 { margin:8px 0 6px; font-size:26px; text-align:center; }
    p { margin:8px 0 16px; color:#ddd; text-align:center; }
    input[type="password"], input[type="text"] { padding:14px; margin:6px 0; border:none; border-radius:8px; background:#222; color:#fff; width:min(420px,92vw); font-size:16px; box-sizing:border-box; }
    .row { display:flex; align-items:center; gap:8px; margin-top:6px; font-size:14px; color:#ccc; }
    button { background:#cc0000; color:#fff; padding:14px 30px; font-size:16px; margin-top:16px; border:none; border-radius:8px; cursor:pointer; width:min(420px,92vw); }
    #status { margin-top:14px; font-size:16px; text-align:center; min-height:22px; }
  </style>
</head>
<body>
  <img src="https://expressfitness.ca/wp-content/uploads/2025/06/X45-LOGO-CUT-OUT-TM.png" alt="X45 Logo" class="logo" />
  <h1>Reset Your Password</h1>
  <p>Enter your new password below.</p>

  <input type="password" id="new-password" placeholder="New Password" />
  <input type="password" id="confirm-password" placeholder="Confirm New Password" />

  <div class="row">
    <input type="checkbox" id="show-password" />
    <label for="show-password">Show Password</label>
  </div>

  <button id="setBtn" type="button">Set New Password</button>
  <div id="status"></div>

  <script>
    const supa = supabase.createClient(
      'https://ajoimwcrmszhmcjrpxjv.supabase.co',
      'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImFqb2ltd2NybXN6aG1janJweGp2Iiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTE5NzYxNzYsImV4cCI6MjA2NzU1MjE3Nn0.4R5iVqe_JKuXZLrGkhBtTFdlHj3xuq99-UhfNbMzWeM'
    );

    document.getElementById('show-password').addEventListener('change', (e)=>{
      const type = e.target.checked ? 'text' : 'password';
      document.getElementById('new-password').type = type;
      document.getElementById('confirm-password').type = type;
    });

    document.getElementById('setBtn').addEventListener('click', async ()=>{
      const status = document.getElementById('status');
      const p1 = document.getElementById('new-password').value;
      const p2 = document.getElementById('confirm-password').value;

      if (p1.length < 6) { status.textContent = '❌ Password must be at least 6 characters.'; status.style.color='orange'; return; }
      if (p1 !== p2) { status.textContent = '❌ Passwords do not match.'; status.style.color='orange'; return; }

      status.textContent = 'Updating…'; status.style.color='white';
      try {
        const { error } = await supa.auth.updateUser({ password: p1 });
        if (error) { status.textContent = '❌ ' + error.message; status.style.color='red'; }
        else { status.textContent = '✅ Password updated. You can now sign in.'; status.style.color='lightgreen'; }
      } catch (err) { status.textContent = '❌ ' + (err.message || 'Unexpected error'); status.style.color='red'; }
    });
  </script>
</body>
</html>
